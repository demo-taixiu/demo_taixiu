<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>T√†i X·ªâu Casino</title>
<link rel="stylesheet" href="style.css">

<style>
body{
    background:radial-gradient(circle,#1f5a34,#0d2517);
    color:#fff;
    font-family:Arial;
}

/* TIMER */
.timer{
    text-align:center;
    font-size:22px;
    font-weight:bold;
    margin:5px 0;
}
.timer.red{
    color:red;
}

/* CHIP */
.chips{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    justify-content:center;
    margin:10px 0;
}
.chip{
    padding:8px 12px;
    border-radius:50px;
    background:gold;
    color:#000;
    font-weight:bold;
    cursor:pointer;
}
.chip.active{
    background:red;
    color:#fff;
}

/* GRID */
.grid{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    gap:4px;
}
.cell{
    border:1px solid rgba(255,255,255,.3);
    padding:12px 5px;
    text-align:center;
    cursor:pointer;
    background:rgba(0,0,0,.3);
}
.cell.active{
    background:gold;
    color:#000;
}

/* DICE */
.dice{
    text-align:center;
    font-size:45px;
    margin:10px 0;
}

/* HISTORY */
.history{
    text-align:center;
    margin-top:10px;
}
</style>
</head>

<body onload="initGame()">

<div class="header">
    üí∞ <span id="balance"></span>
</div>

<div class="timer" id="timer">‚è≥ 30</div>

<div class="dice" id="dice">üé≤ üé≤ üé≤</div>

<!-- CHIP -->
<div class="chips" id="chips"></div>

<div style="text-align:center">
T·ªïng c∆∞·ª£c: <span id="currentBet">0</span>
</div>

<!-- B√ÄN -->
<div class="grid" id="sumGrid"></div>

<div class="history">
üìä C·∫ßu: <span id="stats"></span>
</div>

<script src="app.js"></script>

<script>

let time=30;
let lockBet=false;
let selected=null;
let currentChip=0;
let currentBet=0;
let statsList=JSON.parse(localStorage.getItem("statsList"))||[];

// ===== INIT =====
function initGame(){
    updateHeader();
    createChips();
    createBoard();
    updateStats();
    startTimer();
}

// ===== CHIP =====
const chipValues=[5000,10000,50000,200000,500000,1000000,5000000,10000000,100000000];

function createChips(){
    const box=document.getElementById("chips");
    chipValues.forEach(val=>{
        let div=document.createElement("div");
        div.className="chip";
        div.innerText=format(val);
        div.onclick=()=>{
            document.querySelectorAll(".chip").forEach(c=>c.classList.remove("active"));
            div.classList.add("active");
            currentChip=val;
        };
        box.appendChild(div);
    });
}

function format(n){
    if(n>=1000000) return (n/1000000)+"TR";
    if(n>=1000) return (n/1000)+"K";
    return n;
}

// ===== BOARD =====
const oddsSum={
4:60,5:30,6:18,7:12,8:8,9:7,10:6,
11:6,12:7,13:8,14:12,15:18,16:30,17:60
};

function createBoard(){
    const grid=document.getElementById("sumGrid");
    for(let i=4;i<=17;i++){
        let div=document.createElement("div");
        div.className="cell";
        div.innerHTML=i+"<br>"+oddsSum[i]+":1";
        div.onclick=()=>placeBet(i,div);
        grid.appendChild(div);
    }
}

function placeBet(num,el){
    if(lockBet) return alert("ƒê√£ kh√≥a c∆∞·ª£c!");
    if(!currentChip) return alert("Ch·ªçn chip!");

    selected=num;
    currentBet+=currentChip;

    document.getElementById("currentBet").innerText=
    currentBet.toLocaleString();

    el.classList.add("active");
}

// ===== TIMER =====
function startTimer(){
    setInterval(()=>{
        time--;

        if(time<=5){
            lockBet=true;
            document.getElementById("timer").classList.add("red");
        }else{
            document.getElementById("timer").classList.remove("red");
        }

        if(time<=0){
            runGame();
            time=30;
            lockBet=false;
            currentBet=0;
            document.getElementById("currentBet").innerText=0;
            document.querySelectorAll(".cell").forEach(c=>c.classList.remove("active"));
        }

        document.getElementById("timer").innerText="‚è≥ "+time;
    },1000);
}

// ===== GAME =====
function roll(){return Math.floor(Math.random()*6)+1;}

function runGame(){
    let d1=roll(),d2=roll(),d3=roll();
    let total=d1+d2+d3;

    document.getElementById("dice").innerHTML=
    d1+" üé≤ "+d2+" üé≤ "+d3;

    if(selected && total==selected){
        let win=currentBet*oddsSum[selected];
        balance+=win;
        playWin();
    }else{
        balance-=currentBet;
    }

    vip=Math.floor(balance/2000000)+1;
    save();
    updateHeader();

    // L∆ØU C·∫¶U
    statsList.unshift(total>=11?"T":"X");
    if(statsList.length>50) statsList.pop();
    localStorage.setItem("statsList",JSON.stringify(statsList));
    updateStats();

    selected=null;
}

// ===== FAKE NG∆Ø·ªúI CH∆†I =====
setInterval(()=>{
    let names=["Minh","Huy","An","Long","Khoa","Tu·∫•n"];
    let randomName=names[Math.floor(Math.random()*names.length)];
    let randomMoney=Math.floor(Math.random()*5000000);
    console.log(randomName+" c∆∞·ª£c "+randomMoney);
},2000);

// ===== STATS =====
function updateStats(){
    document.getElementById("stats").innerText=
    statsList.join(" ");
}

// ===== SOUND =====
function playWin(){
    let audio=new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
    audio.play();
}

</script>

</body>
</html>
