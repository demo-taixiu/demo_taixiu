<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>T√†i X·ªâu Casino</title>
<link rel="stylesheet" href="style.css">

<style>
body{
    background:radial-gradient(circle,#1f5a34,#0d2517);
}

/* TIMER */
.timer{
    text-align:center;
    font-size:22px;
    font-weight:bold;
    margin:5px 0;
}

/* ONLINE */
.online{
    text-align:center;
    font-size:14px;
    opacity:.8;
}

/* GRID */
.grid{
    display:grid;
    grid-template-columns:repeat(7,1fr);
    gap:4px;
}

.cell{
    border:1px solid rgba(255,255,255,.3);
    padding:12px 5px;
    text-align:center;
    cursor:pointer;
    background:rgba(0,0,0,.2);
    font-weight:bold;
}

.cell small{
    display:block;
    opacity:.7;
}

.cell.active{
    background:gold;
    color:#000;
}

/* DICE */
.dice{
    text-align:center;
    font-size:45px;
    margin:10px 0;
}

/* B√ÉO EFFECT */
.boom{
    animation:flash 0.3s infinite alternate;
}
@keyframes flash{
    from{background:gold;}
    to{background:#ffcc00;}
}

/* HISTORY */
.history{
    margin-top:10px;
    font-size:14px;
    text-align:center;
}
</style>
</head>

<body onload="updateHeader()">

<div class="header">
    <div>üé≤ T√ÄI X·ªàU CASINO</div>
    <div>üí∞ <span id="balance"></span></div>
</div>

<div class="timer">‚è≥ C√≤n <span id="countdown">30</span>s</div>
<div class="online">üåê <span id="online">200</span> ng∆∞·ªùi ƒëang online</div>

<div class="dice" id="dice">üé≤ üé≤ üé≤</div>

<input type="number" id="betAmount"
placeholder="Nh·∫≠p ti·ªÅn c∆∞·ª£c"
style="width:100%;padding:10px;border-radius:8px;border:none;margin-bottom:10px;">

<!-- B√ÉO -->
<div class="grid" id="baoGrid"></div>

<!-- T·ªîNG -->
<div class="grid" id="sumGrid"></div>

<div id="result" style="text-align:center;margin-top:10px;font-weight:bold"></div>

<div class="history">
üìä Th·ªëng k√™: <span id="stats"></span>
</div>

<script src="app.js"></script>

<script>

// ===== TIMER =====
let time=30;
let lockBet=false;

setInterval(()=>{
    time--;
    if(time<=0){
        runGame();
        time=30;
        lockBet=false;
    }
    if(time<=5) lockBet=true;

    document.getElementById("countdown").innerText=time;
},1000);

// ===== ONLINE FAKE =====
setInterval(()=>{
    document.getElementById("online").innerText=
    180+Math.floor(Math.random()*40);
},2000);

// ===== ODDS =====
const oddsSum={
4:60,5:30,6:18,7:12,8:8,9:7,10:6,
11:6,12:7,13:8,14:12,15:18,16:30,17:60
};

let selected=null;
let statsList=[];

// ===== B√ÉO =====
const baoGrid=document.getElementById("baoGrid");
for(let i=1;i<=6;i++){
    let div=document.createElement("div");
    div.className="cell";
    div.innerHTML=i+":"+i+":"+i+"<small>150:1</small>";
    div.onclick=()=>select(div,"bao"+i);
    baoGrid.appendChild(div);
}

// ===== T·ªîNG =====
const sumGrid=document.getElementById("sumGrid");
for(let i=4;i<=17;i++){
    let div=document.createElement("div");
    div.className="cell";
    div.innerHTML=i+"<small>"+oddsSum[i]+":1</small>";
    div.onclick=()=>select(div,i);
    sumGrid.appendChild(div);
}

function select(el,type){
    if(lockBet) return alert("ƒê√£ kh√≥a c∆∞·ª£c!");
    document.querySelectorAll(".cell").forEach(c=>c.classList.remove("active"));
    el.classList.add("active");
    selected=type;
}

function roll(){return Math.floor(Math.random()*6)+1;}

function runGame(){
    let bet=parseInt(document.getElementById("betAmount").value)||0;

    let d1=roll(),d2=roll(),d3=roll();
    let total=d1+d2+d3;

    document.getElementById("dice").innerHTML=
    d1+" üé≤ "+d2+" üé≤ "+d3;

    let win=0;

    // B√ÉO
    if(selected && selected.includes("bao")){
        let num=parseInt(selected.replace("bao",""));
        if(d1==num&&d2==num&&d3==num){
            win=bet*150;
            document.body.classList.add("boom");
            setTimeout(()=>document.body.classList.remove("boom"),1000);
        }
    }

    // T·ªîNG
    if(typeof selected==="number" && total==selected){
        win=bet*oddsSum[selected];
    }

    if(win>0){
        balance+=win;
        document.getElementById("result").innerHTML="üéâ TH·∫ÆNG +"+win;
        playWinSound();
    }else{
        balance-=bet;
        document.getElementById("result").innerHTML="‚ùå Thua";
    }

    vip=Math.floor(balance/2000000)+1;
    save();
    updateHeader();

    // TH·ªêNG K√ä
    statsList.unshift(total>=11?"T":"X");
    if(statsList.length>20) statsList.pop();
    document.getElementById("stats").innerText=statsList.join(" ");
}

// ===== SOUND =====
function playWinSound(){
    let audio=new Audio("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg");
    audio.play();
}

</script>

</body>
</html>
